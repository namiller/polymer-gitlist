<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="git-elem.html">
<link rel="import" href="../paper-card/paper-card.html">
<dom-module id="git-list">
  <template>
    <style>
      :host {
        display: inline-block;
        width: 100%;
      }
      paper-card {
        padding: 10px;
        margin: 50px 0 0 0;
        width: 100%;
      }
    </style>
    <template is="dom-repeat" items="{{repos}}">
      <paper-card>
        <git-elem repo-data={{item}}></git-elem>
      </paper-card>
    </template>
    <iron-ajax
      auto 
      url="{{link}}"
      method="GET"
      handle-as="json" 
      on-response="_apiResponse">
    </iron-ajax>

  </template>

  <script>
    Polymer({
      is: 'git-list',

      properties: {
        baseUrl: {
          type: String,
          value: 'https://api.github.com/users/',
          observer: '_fixLink',
        },

        user: {
          type: String,
          value: 'Polymer',
          observer: '_fixLink',
        },

        repos: {
          type: Array,
          value: [],
          reflect: true,
        },

        link: {
          type: String,
          value: '',
          reflect: true,
        },
      },

      _apiResponse: function(event, data) {
        this.set('repos', data.xhr.response);
      },

      _fixLink: function() {
        var url = this.get('baseUrl');
        var user = this.get('user');
        if (url && user) {
          this.set('link', url + user + '/repos');
        }
      },

    });
  </script>
</dom-module>
